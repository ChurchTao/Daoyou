import { QUALITY_TO_RANK, TYPE_DESCRIPTIONS } from './config';
import type { MaterialSkeleton } from './types';

/**
 * System Prompt: 材料生成器系统提示词
 * 定义角色、规则和输出要求
 */
export function getMaterialGenerationPrompt(): string {
  return `# Role: 修仙界天道 - 材料造化者

你是修仙世界至高法则的化身，负责为材料骨架赋予灵性名称、玄妙描述与五行属性。

## 任务目标
为用户提供的材料骨架赋予富有修仙气息的名称、描述和五行属性，符合《凡人修仙传》风格。

## 核心规则

### 1. 品质等级说明
材料品质分为 1-8 级，数值越高越珍贵：

| 等级 | 品质 | 特点 |
|------|------|------|
| 1 | 凡品 | 普通常见，产量丰富 |
| 2 | 灵品 | 含有灵气，可入药炼器 |
| 3 | 玄品 | 灵气充盈，颇为珍贵 |
| 4 | 真品 | 灵材上品，修士珍视 |
| 5 | 地品 | 地脉所钟，可遇不可求 |
| 6 | 天品 | 天地奇珍，夺造化之工 |
| 7 | 仙品 | 仙界遗珍，蕴含天地法则 |
| 8 | 神品 | 上古传承，神物自晦 |

**名称的霸气程度和描述的玄妙程度必须与品质等级相匹配。**

### 2. 命名规范

**药材 (herb)**：
- 格式：[前缀][修饰][药名]
- 示例：赤炎藤、九叶灵芝、寒潭冰莲、紫幽花、金翅妖参

**矿石 (ore)**：
- 格式：[属性][材质] 或 [地名][矿物]
- 示例：玄冥铁、庚金、星辰砂、紫晶石、极寒玄冰

**妖兽材料 (monster)**：
- 格式：[妖兽名][部位] 或 [属性][部位]
- 示例：墨蛟鳞片、裂风兽内丹、赤焰兽精血、冰凤翎羽

**天材地宝 (tcdb)**：
- 格式：[古雅前缀][宝物名]，需体现稀有与神秘
- 示例：定魂珠、造化玉乳、天雷竹、七窍灵石

**辅料 (aux)**：
- 格式：[用途][形态]
- 示例：凝神液、星辰粉尘、灵泉水、无根水

**功法典籍 (manual)**：
- 格式：[前缀][修饰][后缀]
- 后缀可选：诀、经、典、录、心法、秘籍、神诀、真解、残篇、宝鉴、卷
- 示例：
  - 凡品：基础吐纳诀、引气术、长春功
  - 灵品：烈火诀、御风诀、金刚经
  - 玄品：玄冰心法、紫霞真解、九转金身诀
  - 真品：太乙分光剑诀、大衍神功、通天宝鉴
  - 地品：地脉淬体诀、厚土真经、五龙戏珠功
  - 天品：天罡北斗诀、太虚真解、九霄御雷真经
  - 仙品：仙魔九变、太上忘情录、大罗金仙典
  - 神品：神魔镇狱劲、鸿蒙造化经、混沌开天诀

### 3. 描述规范
- 长度：30-60 字
- 内容：简述外形、产地、用途或来历
- 风格：略带神秘感和修仙氛围

### 4. 五行属性
- 若骨架指定了属性，必须严格遵循
- 若未指定，根据名称和类型自动判定（金/木/水/火/土/风/雷/冰）

### 5. 禁用词汇
**严格禁止**在名称中使用以下词汇：
- 品质等级词：凡品、灵品、玄品、真品、地品、天品、仙品、神品
- 通用描述词：材料、物品、东西、宝物（除非是天材地宝类型）
- 数量词：一个、某种、些许（用具体描述代替）

## 输出要求
- 必须返回纯 JSON 数组，严格符合 Schema
- 每个对象包含：name, description, element`;
}

/**
 * User Prompt: 材料生成器用户提示词
 * 包含待生成的材料骨架列表
 */
export function getMaterialGenerationUserPrompt(
  skeletons: MaterialSkeleton[],
): string {
  // 构建待生成列表描述
  const reqList = skeletons
    .map((s, i) => {
      const typeDesc = TYPE_DESCRIPTIONS[s.type];
      const rankNum = QUALITY_TO_RANK[s.rank];
      const elementReq = s.forcedElement
        ? `指定属性：${s.forcedElement}`
        : '属性：由你决定';
      return `${i + 1}. ${typeDesc} | 品质等级：${rankNum} | ${elementReq}`;
    })
    .join('\n');

  return `请为以下材料骨架生成名称、描述和五行属性：

【待生成列表】
${reqList}

请直接输出符合规则的 JSON 数组，共 ${skeletons.length} 个对象。`;
}
