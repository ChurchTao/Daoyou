## 实现计划：排行榜神识查探功能

### 1. 功能需求

在排行榜上添加「神识查探」功能，当自身角色的神识（willpower）高于对方时，可以获取对方的详细属性信息。

### 2. 技术实现方案

#### 2.1 后端实现

* **创建API接口**：`/api/rankings/probe/route.ts`

* **功能逻辑**：

  * 接收当前角色ID和目标角色ID

  * 获取双方角色的详细信息

  * 比较双方的 `willpower`（神识）属性

  * 根据比较结果返回不同级别的信息

* **返回数据结构**：

  ```typescript
  {
    success: boolean;
    data: {
      probeSuccess: boolean;
      cultivator: Partial<Cultivator>; // 根据查探结果返回部分或全部属性
      message: string; // 查探结果提示
    };
  }
  ```

#### 2.2 前端实现

* **排行榜页面修改**：在 `rankings/page.tsx` 中每个角色项添加「神识查探」按钮

* **查探状态管理**：

  * 添加查探加载状态

  * 添加查探结果模态框

* **查探逻辑**：

  * 点击查探按钮发送请求到后端API

  * 处理响应结果

  * 显示查探结果

#### 2.3 数据展示

根据查探结果显示不同的信息：

* **成功（神识高于对方）**：显示完整信息

  * 基础属性（体魄、灵力、悟性、速度、神识）

  * 灵根信息

  * 先天命格

  * 装备的法宝

  * 修炼的功法

  * 掌握的神通

* **失败（神识低于对方）**：显示有限信息或提示

  * 仅显示公开信息（如名称、境界、战力）

  * 提示「神识不足，无法查探详细信息」

### 3. 具体实现步骤

#### 3.1 后端实现

1. 创建 `/app/api/rankings/probe/route.ts` 接口文件
2. 实现查探逻辑：

   * 获取当前角色和目标角色信息

   * 比较双方神识属性

   * 返回适当的信息

#### 3.2 前端实现

1. 修改 `/app/rankings/page.tsx`：

   * 添加查探按钮

   * 添加查探状态管理

   * 实现模态框组件展示查探结果
2. 添加查探结果样式和交互
3. 优化用户体验：

   * 添加加载状态

   * 添加查探结果的动画效果

   * 添加查探失败的提示

### 4. 数据安全考虑

* 确保API接口有适当的权限验证

* 防止恶意调用查探API

* 确保返回的数据符合预期格式

* 保护敏感数据不被未授权访问

### 5. 代码结构调整

* 保持现有代码结构不变

* 新增的API接口和组件遵循现有代码风格

* 确保代码可读性和可维护性

<br />

通过以上步骤，我们将实现排行榜的「神识查探」功能，让玩家可以通过神识属性的高低来获取其他角色的详细信息，增强游戏的策略性和趣味性。
